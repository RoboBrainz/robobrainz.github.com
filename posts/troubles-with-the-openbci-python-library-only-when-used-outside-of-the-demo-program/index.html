<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
    <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Troubles with the OpenBCI Python library only when used outside of the demo program | RoboBrainz</title>

    
            <link href="../../assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
        <link href="../../assets/css/rst.css" rel="stylesheet" type="text/css">
        <link href="../../assets/css/code.css" rel="stylesheet" type="text/css">
        <link href="../../assets/css/colorbox.css" rel="stylesheet" type="text/css">
        <link href="../../assets/css/theme.css" rel="stylesheet" type="text/css">

    
            <link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">

      <link rel="canonical" href=".">




    
        <!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]-->

    
<link rel="stylesheet" type="text/css" href="../../assets/css/tipuesearch.css">
</head>
<body>
<div id="tipue_search_content" style="margin-left: auto; margin-right: auto; padding: 20px;"></div>
<link rel="stylesheet" type="text/css" href="//cdn.muut.com/1/moot.css">
<meta name="viewport" content="width=device-width">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">



    

    <meta name="author" content="phora">
        <link rel="prev" href="../spring-semester-a-whole-bunch-of-todos/" title="Spring Semester - A whole bunch of TODOs" type="text/html">
        <link rel="next" href="../crunchtime/" title="Crunchtime!" type="text/html">
    
    <meta property="og:site_name" content="RoboBrainz">
    <meta property="og:title" content="Troubles with the OpenBCI Python library only when used outside of the">
    <meta property="og:url" content="/posts/troubles-with-the-openbci-python-library-only-when-used-outside-of-the-demo-program/">
    <meta property="og:description" content="[EDIT]: Since Monday (2015-04-20), we've been able to implement the bug fix that the OpenBCI
developers have told us in the forum thread when we asked about why our program wouldn't write
to a *.tsv f">
    <meta property="og:type" content="article">
    <meta property="article:published_time" content="2015-04-18T19:37:28-07:00">
           <meta property="article:tag" content="arduino">
           <meta property="article:tag" content="linux">
           <meta property="article:tag" content="openbci">
           <meta property="article:tag" content="python">
           <meta property="article:tag" content="rubix">

    

    





<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="../../">

                <span id="blog-title">RoboBrainz</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                
                <li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/index.html">Tags</a>
                </li>
<li>
<a href="../../rss.xml">RSS feed</a>
                </li>
<li>
<a href="../../about/index.html">About</a>

                
            </li>
</ul>
                
<span class="navbar-form pull-left">
<input type="text" id="tipue_search_input">
</span>

            <ul class="nav navbar-nav navbar-right">
                
                
                    
    <li>
    <a href="index.md" id="sourcelink">Source</a>
    </li>

                
            </ul>
        </div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav>

<!-- End of Menubar -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article">
    
    <header>
        
    <h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Troubles with the OpenBCI Python library only when used outside of the demo program</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn"><a href="https://github.com/phora">phora</a></span></p>
            <p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2015-04-18T19:37:28-07:00" itemprop="datePublished" title="Publication date">2015-04-18 19:37</time></a></p>
                <p class="commentline">
        
	<a href=".#muut-thread">Comments</a><a>

</a></p>
            
        <p class="sourceline"><a href="index.md" id="sourcelink">Source</a></p>

        </div>
        

    </header>

    <div class="e-content entry-content" itemprop="articleBody text">
    <div>
<p><strong>[EDIT]:</strong> Since Monday (2015-04-20), we've been able to implement the bug fix that the OpenBCI<br>
developers have told us in the forum thread when we asked about why our program wouldn't write<br>
to a *.tsv file even when the board was on. The reason why it wouldn't is that we forgot to<br>
do the <a href="http://openbci.com/index.php/forum/#/discussion/comment/2153">init sequence</a> that the<br>
demo program included with the OpenBCI python library was doing before it ran any of the<br>
plugins.</p>
<p>Unfortunately, the project seems to drift farther and farther away even though<br>
we're sure of the algorithms we will use to implement our robot. There's a <a href="https://github.com/RoboBrainz/OpenBCI_EEG_Classifier">draft EEG waveform processor</a> that will most likely be using <a href="http://wiki.scipy.org/Cookbook/ButterworthBandpass">a bandpass filter in SciPy</a> <br>
to reduce as much noise as possible from the outside by limiting the data to <br>
<strong>12.5 Hz</strong> to <strong>30.0 Hz</strong> for the sensors that take EEG asymmetry into account for certain emotions (like sad<br>
evoking beta waves primarily on the left and happy evoking beta waves primarily on the right). The other sensors will most likely read facial gestures to further narrow the idenitified emotion. Alternatively, more<br>
complex classification trends can be found at an <a href="https://sites.google.com/site/biofeedbackpages/function-map">10-20 function map</a>.</p>
<p>While we're working out the EEG classification, we've also started drafting skeleton code for the<br>
<a href="https://github.com/RoboBrainz/Thought-Reactive-Robot-Friend/blob/master/ActionDBTest/ActionDBTest.ino">cart AI</a> <br>
making use of the <a href="https://code.google.com/p/arduino-edb/">EDB</a> library to persistently store scores for action/response pairs. Currently the available actions for the robot haven't been merged into the main code yet.</p>
<p>However, the draft tool for <a href="https://gist.github.com/phora/331728d46e3dcd0e3200#file-manually_labeled_waveforms-py">quickly marking the OpenBCI board's data with emotion labels</a> <br>
is refusing to store any of the packets that're retrieved through the <a href="https://github.com/OpenBCI/OpenBCI_Python">OpenBCI Python API</a>. <br>
This is troublesome because the draft classifier uses the same library as the small tool for manually marking<br>
the data before we store those into a folder that can be easily copied into the <a href="http://smartrubix.com/start-here/">Rubix A-10 board</a> so the EEG classification data can be easily modified. <br>
Additionally, working with the A-10 also allows us to not worry as much about RAM constraints for processing the data.</p>
<p>Currently, here's the terminal output for our program.</p>
<pre class="code literal-block">python2 manually_labeled_waveforms.py /dev/ttyUSB0 
@Connecting to /dev/ttyUSB0
@Serial established...
@ADS1299 Device ID: 0x3E
@LIS3DH Device ID: 0x33
@Free RAM: 447
@$$$
Warning: Warning: Unexpected END_BYTE found &lt;97&gt; instead of &lt;192&gt;,            discarted packet with id &lt;79&gt;
Warning: Warning: Unexpected END_BYTE found &lt;109&gt; instead of &lt;192&gt;,            discarted packet with id &lt;79&gt;
Warning: Warning: Unexpected END_BYTE found &lt;32&gt; instead of &lt;192&gt;,            discarted packet with id &lt;79&gt;
Warning: Warning: Unexpected END_BYTE found &lt;116&gt; instead of &lt;192&gt;,            discarted packet with id &lt;79&gt;
Warning: Warning: Unexpected END_BYTE found &lt;105&gt; instead of &lt;192&gt;,            discarted packet with id &lt;79&gt;
Warning: Warning: Unexpected END_BYTE found &lt;109&gt; instead of &lt;192&gt;,            discarted packet with id &lt;79&gt;
Warning: Warning: Unexpected END_BYTE found &lt;101&gt; instead of &lt;192&gt;,            discarted packet with id &lt;79&gt;
Warning: Warning: Unexpected END_BYTE found &lt;100&gt; instead of &lt;192&gt;,            discarted packet with id &lt;79&gt;
Warning: Warning: Unexpected END_BYTE found &lt;32&gt; instead of &lt;192&gt;,            discarted packet with id &lt;79&gt;
Warning: Warning: Unexpected END_BYTE found &lt;111&gt; instead of &lt;192&gt;,            discarted packet with id &lt;79&gt;
Warning: Warning: Unexpected END_BYTE found &lt;117&gt; instead of &lt;192&gt;,            discarted packet with id &lt;79&gt;
Warning: Warning: Unexpected END_BYTE found &lt;116&gt; instead of &lt;192&gt;,            discarted packet with id &lt;79&gt;
Warning: Warning: Unexpected END_BYTE found &lt;13&gt; instead of &lt;192&gt;,            discarted packet with id &lt;79&gt;
Warning: Warning: Unexpected END_BYTE found &lt;10&gt; instead of &lt;192&gt;,            discarted packet with id &lt;79&gt;
</pre>


<p>The @'d lines only occur if the board is turned on precisely when the program starts.<br>
After this, the program would write a file that contained none of the packets it tried to pick up.</p>
<p>Compare this to the terminal output from <a href="https://github.com/OpenBCI/OpenBCI_Python/blob/master/user.py">the demonstration program that came with the library</a></p>
<pre class="code literal-block"><span class="nv">$ </span>python2 ../OpenBCI_Python/user.py -p /dev/ttyUSB0 --add csv_collect

            USER.py

------------SETTINGS-------------
Notch filtering: True

-------INSTANTIATING BOARD-------
Connecting to /dev/ttyUSB0
Serial established...
No daisy: <span class="m">8</span> EEG channels and <span class="m">3</span> AUX channels at 250.0 Hz.

------------PLUGINS--------------
Found plugins: <span class="o">[</span> print <span class="o">]</span> <span class="o">[</span> udp_server <span class="o">]</span> <span class="o">[</span> csv_collect <span class="o">]</span> <span class="o">[</span> streamer_tcp <span class="o">]</span> <span class="o">[</span> sample_rate <span class="o">]</span>

Activating <span class="o">[</span> csv_collect <span class="o">]</span> plugin...
Will <span class="nb">export </span>CSV to: 2015-4-18_19-40-21.csv
Plugin <span class="o">[</span> csv_collect <span class="o">]</span> added to the list
--------------INFO---------------
User serial interface enabled...
View <span class="nb">command </span>map at http://docs.openbci.com.
Type /start to run -- and /stop before issuing new commands afterwards.
Type /exit to exit. 
Board outputs are automatically printed as: 
%  &lt;tab&gt;  message
<span class="nv">$$$ </span>signals end of message

-------------BEGIN---------------

--&gt; /start
Warning: Skipped <span class="m">158</span> bytes before start found
�
--&gt; Warning: Warning: Unexpected END_BYTE found &lt;160&gt; instead of &lt;192&gt;,            discarted packet with id &lt;0&gt;
Warning: Warning: Unexpected END_BYTE found &lt;1&gt; instead of &lt;192&gt;,            discarted packet with id &lt;0&gt;
Warning: Warning: Unexpected END_BYTE found &lt;130&gt; instead of &lt;192&gt;,            discarted packet with id &lt;0&gt;
Warning: Warning: Unexpected END_BYTE found &lt;243&gt; instead of &lt;192&gt;,            discarted packet with id &lt;0&gt;
Warning: Warning: Unexpected END_BYTE found &lt;224&gt; instead of &lt;192&gt;,            discarted packet with id &lt;0&gt;
Warning: Warning: Unexpected END_BYTE found &lt;130&gt; instead of &lt;192&gt;,            discarted packet with id &lt;0&gt;
Warning: Warning: Unexpected END_BYTE found &lt;252&gt; instead of &lt;192&gt;,            discarted packet with id &lt;0&gt;
Warning: Warning: Unexpected END_BYTE found &lt;246&gt; instead of &lt;192&gt;,            discarted packet with id &lt;0&gt;
Warning: Warning: Unexpected END_BYTE found &lt;129&gt; instead of &lt;192&gt;,            discarted packet with id &lt;0&gt;
Warning: Warning: Unexpected END_BYTE found &lt;124&gt; instead of &lt;192&gt;,            discarted packet with id &lt;0&gt;
Warning: Warning: Unexpected END_BYTE found &lt;148&gt; instead of &lt;192&gt;,            discarted packet with id &lt;0&gt;
Warning: Warning: Unexpected END_BYTE found &lt;128&gt; instead of &lt;192&gt;,            discarted packet with id &lt;0&gt;
Warning: Warning: Unexpected END_BYTE found &lt;0&gt; instead of &lt;192&gt;,            discarted packet with id &lt;0&gt;
Warning: Warning: Unexpected END_BYTE found &lt;0&gt; instead of &lt;192&gt;,            discarted packet with id &lt;0&gt;
Warning: Warning: Unexpected END_BYTE found &lt;130&gt; instead of &lt;192&gt;,            discarted packet with id &lt;0&gt;
Warning: Warning: Unexpected END_BYTE found &lt;228&gt; instead of &lt;192&gt;,            discarted packet with id &lt;0&gt;
Warning: Warning: Unexpected END_BYTE found &lt;157&gt; instead of &lt;192&gt;,            discarted packet with id &lt;0&gt;
Warning: Warning: Unexpected END_BYTE found &lt;130&gt; instead of &lt;192&gt;,            discarted packet with id &lt;0&gt;
Warning: Warning: Unexpected END_BYTE found &lt;240&gt; instead of &lt;192&gt;,            discarted packet with id &lt;0&gt;
Warning: Warning: Unexpected END_BYTE found &lt;154&gt; instead of &lt;192&gt;,            discarted packet with id &lt;0&gt;
Warning: Warning: Unexpected END_BYTE found &lt;129&gt; instead of &lt;192&gt;,            discarted packet with id &lt;0&gt;
Warning: Warning: Unexpected END_BYTE found &lt;90&gt; instead of &lt;192&gt;,            discarted packet with id &lt;0&gt;
Warning: Warning: Unexpected END_BYTE found &lt;200&gt; instead of &lt;192&gt;,            discarted packet with id &lt;0&gt;
Warning: Warning: Unexpected END_BYTE found &lt;128&gt; instead of &lt;192&gt;,            discarted packet with id &lt;0&gt;
Warning: Warning: Unexpected END_BYTE found &lt;0&gt; instead of &lt;192&gt;,            discarted packet with id &lt;0&gt;
Warning: Warning: Unexpected END_BYTE found &lt;0&gt; instead of &lt;192&gt;,            discarted packet with id &lt;0&gt;
Warning: Warning: Unexpected END_BYTE found &lt;0&gt; instead of &lt;192&gt;,            discarted packet with id &lt;0&gt;
Warning: Warning: Unexpected END_BYTE found &lt;0&gt; instead of &lt;192&gt;,            discarted packet with id &lt;0&gt;
Warning: Warning: Unexpected END_BYTE found &lt;0&gt; instead of &lt;192&gt;,            discarted packet with id &lt;0&gt;
Warning: Warning: Unexpected END_BYTE found &lt;0&gt; instead of &lt;192&gt;,            discarted packet with id &lt;0&gt;
Warning: Warning: Unexpected END_BYTE found &lt;0&gt; instead of &lt;192&gt;,            discarted packet with id &lt;0&gt;
Warning: Warning: Unexpected END_BYTE found &lt;0&gt; instead of &lt;192&gt;,            discarted packet with id &lt;0&gt;

--&gt; /exit
Warning: Stopping streaming...
Wait <span class="k">for</span> buffer to flush...
Warning: Closing Serial...
Deactivating Plugins...
Closing, CSV saved to: 2015-4-18_19-40-21.csv
User.py exiting...

<span class="nv">$ </span>ls
total 848K
428K 2015-4-18_14-15-19.csv  4.0K CHANGELOG.md     12K open_bci_v3.pyc      4.0K plugin_interface.pyc  8.0K README.md  4.0K TODO.md  4.0K waveform_classify.py
348K 2015-4-18_19-40-21.csv   16K open_bci_v3.py  4.0K plugin_interface.py  4.0K plugins/              4.0K scripts/   8.0K user.py
</pre>


<p>As the output of ls shows, the data is successfully written to the file with the program that came with the library.</p>
</div>
    </div>
    <aside class="postpromonav">
    <nav>
    
        <ul itemprop="keywords" class="tags">
           <li><a class="tag p-category" href="../../categories/arduino/" rel="tag">arduino</a></li>
           <li><a class="tag p-category" href="../../categories/linux/" rel="tag">linux</a></li>
           <li><a class="tag p-category" href="../../categories/openbci/" rel="tag">openbci</a></li>
           <li><a class="tag p-category" href="../../categories/python/" rel="tag">python</a></li>
           <li><a class="tag p-category" href="../../categories/rubix/" rel="tag">rubix</a></li>
        </ul>

    
        <ul class="pager">
            <li class="previous">
                <a href="../spring-semester-a-whole-bunch-of-todos/" rel="prev" title="Spring Semester - A whole bunch of TODOs">Previous post</a>
            </li>
            <li class="next">
                <a href="../crunchtime/" rel="next" title="Crunchtime!">Next post</a>
            </li>
        </ul>

    </nav>
    </aside>
        <section class="comments">
        <h2>Comments</h2>
        
        
	<div id="muut-thread"></div>
    <a class="muut" href="https://muut.com/i/robobrainz/cache/posts/troubles-with-the-openbci-python-library-only-when-used-outside-of-the-demo-program.html">robobrainz forums</a>


        </section>
    

</article>

        
<script src="//cdn.muut.com/1/moot.min.js"></script>



        </div>
        <!--End of body content-->

        <footer>
            Contents © 2015         <a href="mailto:paraiscc@plu.edu,johnsodm@plu.edu">RoboBrainz</a> - Powered by         <a href="http://getnikola.com" rel="nofollow">Nikola</a>         
            
        </footer>
    </div>
</div>


            <script src="../../assets/js/jquery.min.js"></script>
            <script src="../../assets/js/bootstrap.min.js"></script>
            <script src="../../assets/js/moment-with-locales.min.js"></script>
            <script src="../../assets/js/fancydates.js"></script>
        <script src="../../assets/js/jquery.colorbox-min.js"></script>
    
<!-- Social buttons -->
<div id="addthisbox" class="addthis_toolbox addthis_peekaboo_style addthis_default_style addthis_label_style addthis_32x32_style">
<a class="addthis_button_more">Share</a>
<ul>
<li>
<a class="addthis_button_facebook"></a>
</li>
<li>
<a class="addthis_button_google_plusone_share"></a>
</li>
<li>
<a class="addthis_button_linkedin"></a>
</li>
<li>
<a class="addthis_button_twitter"></a>
</li>
</ul>
</div>
<script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-4f7088a56bb93798"></script>
<!-- End of social buttons -->


    <script>$('a.image-reference:not(.islink)').colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script>
    <!-- fancy dates -->
    <script>
    moment.locale("");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script>
    <!-- end fancy dates -->
    

<script src="../../assets/js/tipuesearch_set.js"></script>
<script src="../../assets/js/tipuesearch.js"></script>
<script src="//cdn.muut.com/1/moot.min.js"></script>
<script>
$(document).ready(function() {
    $('#tipue_search_input').tipuesearch({
        'mode': 'json',
        'contentLocation': '/assets/js/tipuesearch_content.json',
        'showUrl': false
    });
});
</script>



</body>
</html>
